<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Human Maturography Calculator</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <div class="container">
    <h2 class="mb-4 text-center text-primary">Human Maturography Calculator</h2>

    <form id="maturography-form" method="POST">
      <div class="mb-3">
        <label for="age" class="form-label fw-bold">Enter Age:</label>
        <input type="number" class="form-control" id="age" name="age" min="1" max="120" required>
      </div>

      <div id="checklists">
        {% set focus_texts = [
          "Foundational Growth (Motor, Attachment & Language)",
          "Social Awareness (Friends, Empathy & Rules)",
          "Identity Formation (Identity, Emotion & Peer Interest)",
          "Independence and Responsibility (Independence, Responsibility & Beliefs)",
          "Career and Relationship Focus (Career, Relationships & Goals)",
          "Family and Career Advancement (Family, Career, Finance)",
          "Stability and Growth (Stability, Refinement & Health)",
          "Mid-Life Reflection (Reflection, Purpose & Adjustment)",
          "Expanded Responsibility (Responsibility, Mentorship & Legacy)",
          "Self-Actualization (Self-Actualization, Fulfillment)",
          "Wisdom Sharing (Wisdom, Guidance & Priorities)",
          "Preparation for Later Years (Retirement Preparation and Planning)",
          "Legacy and Reflection (Legacy, Family & Contribution)",
          "Emotional Balance (Emotional Balance, Gratitude)",
          "Wisdom and Mentorship (Wisdom, Peace & Mentorship)",
          "Acceptance and Resilience (Acceptance, Resilience and Tradition)",
          "Serenity and Reflection (Serenity, Reflection and Spirituality)",
          "Legacy Fulfillment (Storytelling, Legacy and Family)",
          "Contentment and Inner Peace (Contentment, Peace and Simplicity)",
          "Completion of Legacy (Closure, Reflection and Spirituality)",
          "Extended Reflection (Century Reflection & Unity)",
          "Peaceful Acceptance (Peaceful Acceptance & Dignity)",
          "Gratitude for Longevity (Longevity, Gratitude & Peace)",
          "Final Milestones (Final Wisdom & Closure)"
        ] %}
        
        {% for l in range(1,25) %}
        <div class="checklist-form mb-4 p-3 border rounded bg-white">
          <h4 class="text-primary text-center mb-3">Lustral Map Checklist (L{{l}})</h4>
          <div class="table-responsive">
            <table class="table table-bordered align-middle">
              <thead class="table-primary text-center">
                <tr>
                  <th>Lustrum</th>
                  <th>Focus</th>
                  <th>Checklist for Identification</th>
                  <th>Absent (0)</th>
                  <th>Partially Present (1)</th>
                  <th>Fully Present (2)</th>
                </tr>
              </thead>
              <tbody>
                {% for q in range(1,7) %}
                <tr>
                  {% if q == 1 %}
                  <td rowspan="6" class="text-center align-middle">L{{l}}</td>
                  <td rowspan="6" class="text-center align-middle">{{ focus_texts[l-1] }}</td>
                  {% endif %}
                  <td>Checklist item {{q}}</td>
                  <td><input type="radio" name="l{{l}}_q{{q}}" value="0" required></td>
                  <td><input type="radio" name="l{{l}}_q{{q}}" value="1"></td>
                  <td><input type="radio" name="l{{l}}_q{{q}}" value="2"></td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
        {% endfor %}
      </div>

      <div class="text-center">
        <button type="button" class="btn btn-primary px-5" onclick="submitAll()">Submit</button>
      </div>
    </form>

    <div id="result-container" class="mt-4"></div>

    <div class="text-center mt-4">
      <a href="/admin" class="btn btn-outline-secondary">üîê Admin View</a>
    </div>
  </div>

  <script>
    function submitAll() {
      const btn = document.querySelector("button[onclick='submitAll()']");
      btn.disabled = true;
      const form = document.getElementById('maturography-form');
      const formData = new FormData(form);

      fetch("/submit_results", {
        method: "POST",
        body: formData
      })
      .then(res => res.text())
      .then(html => {
        document.getElementById("result-container").innerHTML = html;
      })
      .catch(err => console.error("Error:", err))
      .finally(() => { btn.disabled = false; });
    }
  </script>
</body>
</html>
